<html>
	<head>
		<script src="jquery-1.7.1.min.js" type="text/javascript"></script>
		<script src="raphael-min.js" type="text/javascript"></script>
		<script src="vuelitemodel.js"></script>
		<script src="vuerender.js"></script>
	</head>
    <body>
    	<center id="prepare">
			<img src="loading.gif"><br/>
			<font face="verdana"><h1><font color="red">V</font><font color="orange">U</font><font color="purple">E</font> <font color="darkgreen">Reader</font> preparing</h1></font>
		</center>
		<script language="JavaScript">
			var model;
			//Mouse interactivity
			function MouseStart() {
				var moving = false;
				var stx, sty;
				$('#holder')
					.mousedown(function(eobj){
						if (eobj.which!=2) return;
						stx = eobj.clientX;
						sty = eobj.clientY;
						moving=true;
						eobj.stopPropagation();
						eobj.preventDefault();
					})
					.mousemove(function(eobj){
						if (!moving) return;
						$('#holder').css('left',parseFloat($('#holder').css('left'))+eobj.clientX-stx);
						$('#holder').css('top',parseFloat($('#holder').css('top'))+eobj.clientY-sty);
						stx = eobj.clientX;
						sty = eobj.clientY;
						eobj.stopPropagation();
						eobj.preventDefault();
					})
					.mouseup(function(eobj){
						if (!moving) return;
						if (eobj.which!=2) return;
						moving = false;
						eobj.stopPropagation();
						eobj.preventDefault();
						return false;
					});
			}
			$(setTimeout(function(){
				$('#logpane').prepend('Program loaded.<br/>');
				$.ajax({
					type: 'GET',
					url: 'data.vue',
					dataType: 'text',
					success: function(data) {
						/*Fix VUE to follow standard*/
						var xml = $.parseXML('<?xml version="1.0" encoding="US-ASCII"?>'+data.replace('<?xml version="1.0" encoding="US-ASCII"?>',''));
						
						model = new VUELiteModel(xml);
						VUERender(model, "holder"); //Change this on demand
						
						$('#prepare').hide();
						$('#logpane').hide();
						
						MouseStart();
					}
				});
			},1000));
		</script>
		<div id="logpane" style="position:absolute; left:0; top:0; background-color:darkgreen; color:white;"></div>
		<div id="holdvp">
		<div id="holder" style="position:absolute;left:0;top:0;"></div>
		</div>	
    </body>
</html>
